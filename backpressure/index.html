<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="author" content="Oleksii Zghurskyi"><meta name="robots" content="all"><title>Back-pressure patterns in practice</title><meta name="description" content="Back-pressure is an important feedback mechanism that allows systems to gracefully respond to load rather than collapse under it. The back-pressure may cascade all the way up to the user, at which point responsiveness may degrade, but this mechanism wi..."><meta name="keywords" content="back-pressure"><link rel="shortcut icon" type="image/png" href="/favicon.png"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com"><link rel="dns-prefetch" href="//disqus.com"><link rel="dns-prefetch" href="//c.disquscdn.com"><link rel="canonical" href="https://www.oxymorus.com/backpressure/"><link rel="alternate" type="application/rss+xml" title="Oxymorus Blog" href="/atom.xml"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/androidstudio.min.css"><link rel="stylesheet" href="/css/main.css?v=33"><link rel="stylesheet" href="/css/conum.css?v=33"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Droid+Sans+Mono:400,700"><meta name="description" content="Back-pressure is an important feedback mechanism that allows systems to gracefully respond to load rather than collapse under it. The back-pressure may cascade all the way up to the user, at which poi"><meta name="keywords" content="back-pressure"><meta property="og:type" content="article"><meta property="og:title" content="Back-pressure patterns in practice"><meta property="og:url" content="https://www.oxymorus.com/backpressure/index.html"><meta property="og:site_name" content="Oxymorus Blog"><meta property="og:description" content="Back-pressure is an important feedback mechanism that allows systems to gracefully respond to load rather than collapse under it. The back-pressure may cascade all the way up to the user, at which poi"><meta property="og:locale" content="en"><meta property="og:image" content="https://www.oxymorus.com/images/bg-index.jpg"><meta property="og:updated_time" content="2019-10-07T10:58:44.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Back-pressure patterns in practice"><meta name="twitter:description" content="Back-pressure is an important feedback mechanism that allows systems to gracefully respond to load rather than collapse under it. The back-pressure may cascade all the way up to the user, at which poi"><meta name="twitter:image" content="https://www.oxymorus.com/images/bg-index.jpg"><meta name="twitter:creator" content="@zghurskyi"><script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.oxymorus.com/backpressure/"},"headline":"Back-pressure patterns in practice","image":{"@type":"ImageObject","url":"https://www.oxymorus.com/images/bg-index.jpg"},"datePublished":"2019-06-19T10:58:44.000Z","dateModified":"2019-10-07T10:58:44.000Z","author":{"@type":"Person","name":"Oleksii Zghurskyi"},"publisher":{"@type":"Organization","name":"Oxymorus Blog","logo":{"@type":"ImageObject","url":"https://www.oxymorus.com/images/site-logo.jpg","height":60,"width":600}},"description":"Back-pressure is an important feedback mechanism that allows systems to gracefully respond to load rather than collapse under it. The back-pressure may cascade all the way up to the user, at which point responsiveness may degrade, but this mechanism will ensure that the system is resilient under load.","keywords":"back-pressure"}</script></head><body class="layout-post"><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class="container-fluid"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#main-navbar" class="navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" style="color:#000" class="navbar-brand"><span>Home</span></a></div><div id="main-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/archives">Archive</a></li><li><a href="https://github.com/zghurskyi/zghurskyi.github.io">Github</a></li><li><a href="https://travis-ci.org/zghurskyi/zghurskyi.github.io"><img src="https://travis-ci.org/zghurskyi/zghurskyi.github.io.png?branch=develop"></a></li></ul></div></div></nav><header class="header-section"><div style="background-image:url(/img/post-bg-12.jpg)" class="intro-header"><div class="container"><div class="row"><div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1"><div class="post-heading"><a href="/categories/reactive/" class="category">Reactive</a><a href="/categories/reactive/back-pressure/" class="category">Back-Pressure</a><h1>Back-pressure patterns in practice</h1><div class="post-meta"><ul><li><time datetime="2019-06-19T10:58:44.000Z" itemprop="datePublished">Jun 19, 2019</time></li><li>3 minutes read</li><li><a href="https://www.oxymorus.com/backpressure/#disqus_thread">0 Comments</a></li></ul></div></div></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1"><article role="main" class="blog-post"><div class="paragraph"><p>Back-pressure is an important feedback mechanism that allows systems to gracefully respond to load rather than collapse under it. The back-pressure may cascade all the way up to the user, at which point responsiveness may degrade, but this mechanism will ensure that the system is resilient under load.</p></div><a id="more"></a><div class="sect1"><h2>Back-Pressure</h2><div class="sectionbody"><div class="paragraph"><p>This is how it&#8217;s defined in <a href="https://www.reactivemanifesto.org/glossary#Back-Pressure" target="_blank" rel="noopener">Reactive Manifesto</a>:</p></div><div class="quoteblock"><blockquote><div class="paragraph"><p><strong>Back-Pressure</strong></p></div><div class="paragraph"><p>When one component is struggling to keep-up, the system as a whole needs to respond in a sensible way. It is unacceptable for the component under stress to fail catastrophically or to drop messages in an uncontrolled fashion. Since it can’t cope and it can’t fail it should communicate the fact that it is under stress to upstream components and so get them to reduce the load. This back-pressure is an important feedback mechanism that allows systems to gracefully respond to load rather than collapse under it. The back-pressure may cascade all the way up to the user, at which point responsiveness may degrade, but this mechanism will ensure that the system is resilient under load, and will provide information that may allow the system itself to apply other resources to help distribute the load.</p></div></blockquote></div><div class="paragraph"><p>Let&#8217;s illustrate the context, that requires to apply back-pressure.</p></div><div class="openblock text-center"><div class="content"><div class="imageblock img-responsive img-thumbnail"><div class="content"><a class="image" href="/images/backpressure.png"><img src="/images/backpressure.png" alt="backpressure"></a></div></div></div></div><div class="paragraph"><p>So, essentially the problem here is the mismatch in throughput between services.</p></div></div></div><div class="sect1"><h2>Strategies to deal with throughput mismatch</h2><div class="sectionbody"><div class="paragraph"><p>There are several strategies to deal with throughput mismatch:</p></div><div class="ulist"><ul><li><p><em>Auto-scale</em> service, that is under pressure</p></li><li><p><em>Drop down (or sample)</em> incoming requests, once service under pressure is saturated</p></li><li><p><em>Buffer</em> requests</p></li><li><p><em>Control</em> the request producer</p></li></ul></div><div class="sect2"><h3>Auto-scaling</h3><div class="paragraph"><p>Probably, auto-scaling is the easiest way to deal with the problem. E.g. in the example above the solution would be to scale the <strong>service B</strong> up - this definitely will resolve throughput deficit. In some cases this will be just enough, but in other - auto-scaling might lead to propagating the problem to the next service (e.g. <strong>service C</strong>). Also, if you are in severe cost/hardware deficit, scaling up is simply not feasible.</p></div></div><div class="sect2"><h3>Dropping down or sampling</h3><div class="paragraph"><p>Only some fraction of incoming requests is processed, other are simply ignored. E.g. in the example above to solve the problem it would be enough for <strong>service B</strong> to just skip processing every 3rd request. However, most often it&#8217;s not applicable in practice</p></div></div><div class="sect2"><h3>Buffering requests</h3><div class="paragraph"><p>Probably, applying buffer is the most intuitive thing to do. E.g. in the example above this approach can be implemented by introducing messaging queue between <strong>service A and B</strong> or, alternatively, storing incoming request to the database. This, in essence, allows <strong>service B</strong> to pull requests from buffer, when it&#8217;s ready to process them. However, beside the complication in infrastructure it&#8217;s not always possible, since not all requests might be processed asynchronously.</p></div></div><div class="sect2"><h3>Controlling the request producer</h3><div class="paragraph"><p>Controlling the request producer is, actually, defined as"back-pressure" by Reactive Manifesto. In the example above it means, that <strong>service B</strong> should be able to slow down/speed up <strong>service A</strong>. So, <strong>service A</strong> should not <em>push</em> requests to <strong>service B</strong>, instead <strong>service B</strong> should <em>pull</em> desired number of requests from <strong>service A</strong>. However, controlling producer speed is not always an option (imaging telling your user to slow down). Also, back-pressure mechanism introduces complexity in the system, so should be decided carefully.</p></div></div></div></div><div class="sect1"><h2>Conclusion</h2><div class="sectionbody"><div class="paragraph"><p>Whenever there is a mismatch in throughput between services there might be the opportunity to apply back-pressure pattern.</p></div><div class="paragraph"><p>What strategy should be applied really depends on the constraints and requirements at hand.</p></div></div></div><section class="post-tags"><a href="/tags/back-pressure/" class="tag post-meta">#back-pressure</a></section><footer class="post-footer"><img src="https://www.gravatar.com/avatar/729584bb1060b4346ad910cf602ffc1c?s=200" class="img-responsive img-circle"><div class="row author"><div class="col-lg-8 col-lg-offset-2 col-xs-10 col-xs-offset-1"><h4>Oleksii Zghurskyi</h4><p></p><ul class="social-links"><li><a href="https://twitter.com/zghurskyi" onclick="return window.open(this.href),!1"><span class="fa fa-twitter"></span></a></li><li><a href="https://github.com/zghurskyi" onclick="return window.open(this.href),!1"><span class="fa fa-github"></span></a></li><li><a href="https://stackoverflow.com/users/2810730/oleksii-zghurskyi?tab=profile" onclick="return window.open(this.href),!1"><span class="fa fa-stack-overflow"></span></a></li><li><a href="https://www.linkedin.com/in/oleksii-zghurskyi-96500175/" onclick="return window.open(this.href),!1"><span class="fa fa-linkedin"></span></a></li></ul></div></div></footer><section class="related-posts"><h2>You may also like</h2><div class="row"></div></section></article><nav role="pagination" class="pagination"><a href="/database-transaction/" class="pull-left btn">← Next post</a><a href="/blocking-vs-nonblocking/" class="pull-right btn">Previous post →</a></nav><div class="disqus-comments"><div class="comments"><div id="disqus_thread"></div></div></div><script>var url_parts=window.location.href.split("?"),disqus_url=url_parts[0];!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="//oxymorus.disqus.com/embed.js",(document.head||d.body).appendChild(t)}()</script></div></div></div><script id="dsq-count-scr" src="//oxymorus.disqus.com/count.js"></script><footer class="site-footer"><div class="container-fluid"><div class="row"><div class="col-lg-10 col-lg-offset-1 col-xs-10 col-xs-offset-1"><div class="row"><div class="col-lg-4"><h4>https://www.oxymorus.com/ © 2020</h4><p><em>"Lock it, fill it, curl it, find it, View it, code it, jam, unlock it"</em></p><p><a href="/privacy-policy/">Privacy policy</a></p><p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"></a></p></div><div class="col-lg-4"><h4 class="marked">Recent articles</h4><section class="recent-posts"><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/observability/">Monitoring Spring Boot service with Prometheus and Grafana</a></li><li class="post-list-item"><a class="post-list-link" href="/installing-kubernetes/">Installing Kubernetes with microk8s</a></li><li class="post-list-item"><a class="post-list-link" href="/maven-package-to-multiple-java-versions/">Maven: Packaging to multiple Java versions</a></li><li class="post-list-item"><a class="post-list-link" href="/java-repl/">JShell: Awesome Java REPL</a></li><li class="post-list-item"><a class="post-list-link" href="/gatling-load-testing/">Load testing with Gatling</a></li><li class="post-list-item"><a class="post-list-link" href="/decorator/">Different ways to implement Decorator Pattern</a></li></ul></section></div><div class="col-lg-4"><h4 class="marked">Stay connected</h4><div class="social-links"><ul><li><a href="https://twitter.com/zghurskyi" onclick="return window.open(this.href),!1"><span class="fa fa-twitter"></span></a></li><li><a href="https://github.com/zghurskyi" onclick="return window.open(this.href),!1"><span class="fa fa-github"></span></a></li><li><a href="https://stackoverflow.com/users/2810730/oleksii-zghurskyi?tab=profile" onclick="return window.open(this.href),!1"><span class="fa fa-stack-overflow"></span></a></li><li><a href="https://www.linkedin.com/in/oleksii-zghurskyi-96500175/" onclick="return window.open(this.href),!1"><span class="fa fa-linkedin"></span></a></li></ul></div><h4 class="marked">Most popular tags</h4><section class="tagcloud"><a href="/tags/acid/" style="font-size:8pt;color:#6a6a6a">ACID</a> <a href="/tags/aerospike/" style="font-size:16pt;color:#858585">Aerospike</a> <a href="/tags/apache-camel/" style="font-size:16pt;color:#858585">Apache Camel</a> <a href="/tags/apache-kafka/" style="font-size:24pt;color:#9f9f9f">Apache Kafka</a> <a href="/tags/authentication/" style="font-size:8pt;color:#6a6a6a">Authentication</a> <a href="/tags/data-access-layer/" style="font-size:16pt;color:#858585">Data Access Layer</a> <a href="/tags/decorator-pattern/" style="font-size:8pt;color:#6a6a6a">Decorator pattern</a> <a href="/tags/docker/" style="font-size:32pt;color:#bababa">Docker</a> <a href="/tags/dynamic-routes/" style="font-size:8pt;color:#6a6a6a">Dynamic Routes</a> <a href="/tags/grafana/" style="font-size:8pt;color:#6a6a6a">Grafana</a> <a href="/tags/isolation/" style="font-size:8pt;color:#6a6a6a">Isolation</a> <a href="/tags/java-11/" style="font-size:16pt;color:#858585">Java 11</a> <a href="/tags/java-8/" style="font-size:16pt;color:#858585">Java 8</a> <a href="/tags/lost-update/" style="font-size:8pt;color:#6a6a6a">Lost Update</a> <a href="/tags/maven/" style="font-size:16pt;color:#858585">Maven</a> <a href="/tags/multi-factor/" style="font-size:8pt;color:#6a6a6a">Multi-Factor</a> <a href="/tags/mysql/" style="font-size:8pt;color:#6a6a6a">MySQL</a> <a href="/tags/optimistic-locking/" style="font-size:16pt;color:#858585">Optimistic Locking</a> <a href="/tags/pessimistic-locking/" style="font-size:16pt;color:#858585">Pessimistic Locking</a> <a href="/tags/project-reactor/" style="font-size:16pt;color:#858585">Project Reactor</a> <a href="/tags/prometheus/" style="font-size:8pt;color:#6a6a6a">Prometheus</a> <a href="/tags/spring-boot/" style="font-size:24pt;color:#9f9f9f">Spring Boot</a> <a href="/tags/transaction/" style="font-size:8pt;color:#6a6a6a">Transaction</a> <a href="/tags/clone/" style="font-size:8pt;color:#6a6a6a">clone</a> <a href="/tags/jq/" style="font-size:8pt;color:#6a6a6a">jq</a></section></div></div></div></div></div><section class="poweredby"><ul class="text-center"><li><span>Published with </span><a href="https://hexo.io" onclick="return window.open(this.href),!1"><img src="/img/logo-hexo.png"></a></li><li><span>Hosted on </span><a href="https://github.com/zghurskyi/zghurskyi.github.io" onclick="return window.open(this.href),!1"><img src="/img/logo-github.png"></a></li><li><span>Deployed with </span><a href="https://travis-ci.org/zghurskyi/zghurskyi.github.io" onclick="return window.open(this.href),!1"><img src="/img/logo-travis.png"></a></li></ul></section></footer><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script id="cookiebanner" src="//cdnjs.cloudflare.com/ajax/libs/cookie-banner/1.2.2/cookiebanner.min.js" data-moreinfo="/privacy-policy/" data-message="This blog uses cookies to enhance your experience. By continuing to visit it you agree to its use of cookies." data-link="#ffad33" data-font-family="Lora,serif" data-font-size="1.6rem" data-bg="#444"></script><script src="/js/main.js?v=5"></script><script src="/js/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad()</script><script>"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&(!function(a,e,n,o,t,c,g){a.GoogleAnalyticsObject=t,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,c=e.createElement(n),g=e.getElementsByTagName(n)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",g.parentNode.insertBefore(c,g)}(window,document,"script",0,"ga"),ga("create","UA-143749857-1","auto"),ga("send","pageview"))</script></body></html>